<?php   function xlsBOF() {    echo pack("ssssss", 0x809, 0x8, 0x0, 0x10, 0x0, 0x0);     return;}function xlsEOF() {    echo pack("ss", 0x0A, 0x00);    return;}function xlsWriteNumber($Row, $Col, $Value) {    echo pack("sssss", 0x203, 14, $Row, $Col, 0x0);    echo pack("d", $Value);    return;}function xlsWriteLabel($Row, $Col, $Value ) {    $L = strlen($Value);    echo iconv("cp1251", "utf-8", pack("ssssss", 0x204, 8 + $L, $Row, $Col, 0x0, $L));    echo $Value;    return;}header("Content-Type: application/force-download");header("Content-Type: application/octet-stream");header("Content-Type: application/download");header( "Content-type: application/vnd.ms-excel; charset=UTF-8" );header("Content-Disposition: attachment;filename=list.xls");header("Pragma: no-cache");header("Expires: 0");xlsBOF();xlsWriteLabel(0,0,iconv("utf-8","cp1251", "Номер")); xlsWriteLabel(0,1,iconv("utf-8","cp1251", "Наименование банка"));xlsWriteLabel(0,2,iconv("utf-8","cp1251", "Страна")); xlsWriteLabel(0,3,iconv("utf-8","cp1251", "Класс надежности")); xlsWriteLabel(0,4,iconv("utf-8","cp1251", "Название программы")); xlsWriteLabel(0,5,iconv("utf-8","cp1251", "% годовых"));xlsWriteLabel(0,6,iconv("utf-8","cp1251", "Сумма всех вкладов такого типа")); $conn=mysqli_connect("eu-cdbr-west-02.cleardb.net", "b94b976f849e9f", "f60a7bfb") or die ("Невозможноподключиться к серверу"); // установление соединения с сервером mysqli_query($conn,'SET NAMES cp1251'); // тип кодировки // подключение к базе данных: mysqli_select_db($conn,"heroku_60a6c74570f65ce") or die("Нет такой таблицы!"); $result = mysqli_query($conn, "SELECT banks.name as 'bank', banks.country as 'country', banks.class as 'class', deposit.name as 'dep', deposit.perc as 'perc', (SELECT SUM(vklad.start) FROM vklad WHERE (deposit.id_dep=vklad.id_dep)) as 'summa' FROM banks LEFT JOIN deposit ON (banks.id_bank=deposit.id_bank) LEFT JOIN vklad ON (vklad.id_dep=deposit.id_dep)");$i=1;    while($row=mysqli_fetch_array($result)){         xlsWriteLabel($i,0,$i);xlsWriteLabel($i,1,$row['bank']); xlsWriteLabel($i,2,$row['country']);xlsWriteLabel($i,3,$row['class']); xlsWriteLabel($i,4,$row['dep']); xlsWriteLabel($i,5,$row['perc']); xlsWriteLabel($i,6,$row['summa']); $i++;     }xlsEOF();exit;